function Calendar(b,f,e,d,a,c){this.beginYear=b||1990;this.endYear=f||2020;this.language=e||0;this.patternDelimiter=d||"-";this.date2StringPattern=a||Calendar.language.date2StringPattern[this.language].replace(/\-/g,this.patternDelimiter);this.string2DatePattern=c||Calendar.language.string2DatePattern[this.language];this.dateControl=null;this.panel=this.getElementById("__calendarPanel");this.iframe=window.frames.__calendarIframe;this.form=null;this.date=new Date();this.year=this.date.getFullYear();this.month=this.date.getMonth();this.colors={bg_cur_day:"#00CC33",bg_over:"#EFEFEF",bg_out:"#FFCC00"}}Calendar.language={year:["\u5e74","","","\u5e74"],months:[["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"]],weeks:[["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],["Sun","Mon","Tur","Wed","Thu","Fri","Sat"],["Sun","Mon","Tur","Wed","Thu","Fri","Sat"],["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"]],clear:["\u6e05\u7a7a","Clear","Clear","\u6e05\u7a7a"],today:["\u4eca\u5929","Today","Today","\u4eca\u5929"],close:["\u5173\u95ed","Close","Close","\u95dc\u9589"],date2StringPattern:["yyyy-MM-dd","yyyy-MM-dd","yyyy-MM-dd","yyyy-MM-dd"],string2DatePattern:["ymd","ymd","ymd","ymd"]};Calendar.prototype.draw=function(){calendar=this;var c=[];c[c.length]='<form id="__calendarForm" name="__calendarForm" method="post">';c[c.length]='<table id="__calendarTable" width="100%" border="0" cellpadding="3" cellspacing="1" align="center">';c[c.length]=" <tr>";c[c.length]='  <th><input class="l" name="goPrevMonthButton" type="button" id="goPrevMonthButton" value="&lt;" /></th>';c[c.length]='  <th colspan="5"><select class="year" name="yearSelect" id="yearSelect"></select><select class="month" name="monthSelect" id="monthSelect"></select></th>';c[c.length]='  <th><input class="r" name="goNextMonthButton" type="button" id="goNextMonthButton" value="&gt;" /></th>';c[c.length]=" </tr>";c[c.length]=" <tr>";for(var b=0;b<7;b++){c[c.length]='<th class="theader">';c[c.length]=Calendar.language.weeks[this.language][b];c[c.length]="</th>"}c[c.length]="</tr>";for(var b=0;b<6;b++){c[c.length]='<tr align="center">';for(var a=0;a<7;a++){switch(a){case 0:c[c.length]='<td class="sun">&nbsp;</td>';break;case 6:c[c.length]='<td class="sat">&nbsp;</td>';break;default:c[c.length]='<td class="normal">&nbsp;</td>';break}}c[c.length]="</tr>"}c[c.length]=" <tr>";c[c.length]='  <th colspan="2"><input type="button" class="b" name="clearButton" id="clearButton" /></th>';c[c.length]='  <th colspan="3"><input type="button" class="b" name="selectTodayButton" id="selectTodayButton" /></th>';c[c.length]='  <th colspan="2"><input type="button" class="b" name="closeButton" id="closeButton" /></th>';c[c.length]=" </tr>";c[c.length]="</table>";c[c.length]="</form>";this.iframe.document.body.innerHTML=c.join("");this.form=this.iframe.document.forms.__calendarForm;this.form.clearButton.value=Calendar.language.clear[this.language];this.form.selectTodayButton.value=Calendar.language.today[this.language];this.form.closeButton.value=Calendar.language.close[this.language];this.form.goPrevMonthButton.onclick=function(){calendar.goPrevMonth(this)};this.form.goNextMonthButton.onclick=function(){calendar.goNextMonth(this)};this.form.yearSelect.onchange=function(){calendar.update(this)};this.form.monthSelect.onchange=function(){calendar.update(this)};this.form.clearButton.onclick=function(){calendar.dateControl.value="";calendar.hide()};this.form.closeButton.onclick=function(){calendar.hide()};this.form.selectTodayButton.onclick=function(){var d=new Date();calendar.date=d;calendar.year=d.getFullYear();calendar.month=d.getMonth();calendar.dateControl.value=d.format(calendar.date2StringPattern);calendar.hide()}};Calendar.prototype.bindYear=function(){var b=this.form.yearSelect;b.length=0;for(var a=this.beginYear;a<=this.endYear;a++){b.options[b.length]=new Option(a+Calendar.language.year[this.language],a)}};Calendar.prototype.bindMonth=function(){var a=this.form.monthSelect;a.length=0;for(var b=0;b<12;b++){a.options[a.length]=new Option(Calendar.language.months[this.language][b],b)}};Calendar.prototype.goPrevMonth=function(a){if(this.year==this.beginYear&&this.month==0){return}this.month--;if(this.month==-1){this.year--;this.month=11}this.date=new Date(this.year,this.month,1);this.changeSelect();this.bindData()};Calendar.prototype.goNextMonth=function(a){if(this.year==this.endYear&&this.month==11){return}this.month++;if(this.month==12){this.year++;this.month=0}this.date=new Date(this.year,this.month,1);this.changeSelect();this.bindData()};Calendar.prototype.changeSelect=function(){var c=this.form.yearSelect;var a=this.form.monthSelect;for(var b=0;b<c.length;b++){if(c.options[b].value==this.date.getFullYear()){c[b].selected=true;break}}for(var b=0;b<a.length;b++){if(a.options[b].value==this.date.getMonth()){a[b].selected=true;break}}};Calendar.prototype.update=function(a){this.year=a.form.yearSelect.options[a.form.yearSelect.selectedIndex].value;this.month=a.form.monthSelect.options[a.form.monthSelect.selectedIndex].value;this.date=new Date(this.year,this.month,1);this.changeSelect();this.bindData()};Calendar.prototype.bindData=function(){var e=this;var d=this.getMonthViewDateArray(this.date.getFullYear(),this.date.getMonth());var c=this.getElementsByTagName("td",this.getElementById("__calendarTable",this.iframe.document));for(var b=0;b<c.length;b++){c[b].style.backgroundColor=e.colors.bg_over;c[b].onclick=null;c[b].onmouseover=null;c[b].onmouseout=null;c[b].innerHTML=d[b]||"&nbsp;";if(b>d.length-1){continue}if(d[b]){c[b].onclick=function(){var f=e.dateControl.value;if(e.dateControl){e.dateControl.value=new Date(e.date.getFullYear(),e.date.getMonth(),this.innerHTML).format(e.date2StringPattern)}e.hide();if(f!=e.dateControl.value){if(e.dateControl.onchange){e.dateControl.onchange()}}};var a=new Date();if(a.getFullYear()==e.date.getFullYear()&&a.getMonth()==e.date.getMonth()&&a.getDate()==d[b]){c[b].style.backgroundColor=e.colors.bg_cur_day;c[b].onmouseover=function(){this.style.backgroundColor=e.colors.bg_out};c[b].onmouseout=function(){this.style.backgroundColor=e.colors.bg_cur_day}}else{if(e.date.getDate()==d[b]){c[b].style.backgroundColor=e.colors.bg_out}else{c[b].onmouseover=function(){this.style.backgroundColor=e.colors.bg_out};c[b].onmouseout=function(){this.style.backgroundColor=e.colors.bg_over}}}}}};Calendar.prototype.getMonthViewDateArray=function(f,a){var d=new Array(42);var b=new Date(f,a,1).getDay();var e=new Date(f,a+1,0).getDate();for(var c=0;c<e;c++){d[c+b]=c+1}return d};Calendar.prototype.show=function(a,c){if(this.panel.style.visibility=="visible"){this.panel.style.visibility="hidden"}if(!a){throw new Error("arguments[0] is necessary!")}this.dateControl=a;c=c||a;this.draw();this.bindYear();this.bindMonth();if(a.value.length>0){this.date=new Date(a.value.toDate(this.patternDelimiter,this.string2DatePattern));this.year=this.date.getFullYear();this.month=this.date.getMonth()}this.changeSelect();this.bindData();var b=this.getAbsPoint(c);this.panel.style.left=b.x+"px";this.panel.style.top=(b.y+a.offsetHeight)+"px";this.panel.style.visibility="visible"};Calendar.prototype.hide=function(){this.panel.style.visibility="hidden"};Calendar.prototype.getElementById=function(b,a){a=a||document;return document.getElementById?a.getElementById(b):document.all(b)};Calendar.prototype.getElementsByTagName=function(b,a){a=a||document;return document.getElementsByTagName?a.getElementsByTagName(b):document.all.tags(b)};Calendar.prototype.getAbsPoint=function(b){var a=b.offsetLeft;var c=b.offsetTop;while(b=b.offsetParent){a+=b.offsetLeft;c+=b.offsetTop}return{x:a,y:c}};Date.prototype.format=function(b){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(b)){b=b.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var a in c){if(new RegExp("("+a+")").test(b)){b=b.replace(RegExp.$1,RegExp.$1.length==1?c[a]:("00"+c[a]).substr((""+c[a]).length))}}return b};String.prototype.toDate=function(e,f){e=e||"-";f=f||"ymd";var c=this.split(e);var h=parseInt(c[f.indexOf("y")],10);if(h.toString().length<=2){h+=2000}if(isNaN(h)){h=new Date().getFullYear()}var b=parseInt(c[f.indexOf("m")],10)-1;var g=parseInt(c[f.indexOf("d")],10);if(isNaN(g)){g=1}return new Date(h,b,g)};document.writeln('<div id="__calendarPanel" style="position:absolute;visibility:hidden;z-index:9999;background-color:#FFFFFF;border:1px solid #666666;width:200px;height:216px;">');document.writeln('<iframe name="__calendarIframe" id="__calendarIframe" width="100%" height="100%" scrolling="no" frameborder="0" style="margin:0px;"></iframe>');var __ci=window.frames.__calendarIframe;__ci.document.writeln('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');__ci.document.writeln('<html xmlns="http://www.w3.org/1999/xhtml">');__ci.document.writeln("<head>");__ci.document.writeln('<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />');__ci.document.writeln("<title>Web Calendar(UTF-8) Written By KimSoft</title>");__ci.document.writeln('<style type="text/css">');__ci.document.writeln("<!--");__ci.document.writeln("body {font-size:12px;margin:0px;text-align:center;}");__ci.document.writeln("form {margin:0px;}");__ci.document.writeln("select {font-size:12px;background-color:#EFEFEF;}");__ci.document.writeln("table {border:0px solid #CCCCCC;background-color:#FFFFFF}");__ci.document.writeln("th {font-size:12px;font-weight:normal;background-color:#FFFFFF;}");__ci.document.writeln("th.theader {font-weight:normal;background-color:#666666;color:#FFFFFF;width:24px;}");__ci.document.writeln("select.year {width:66px;}");__ci.document.writeln("select.month {width:60px;}");__ci.document.writeln("td {font-size:12px;text-align:center;}");__ci.document.writeln("td.sat {color:#0000FF;background-color:#EFEFEF;}");__ci.document.writeln("td.sun {color:#FF0000;background-color:#EFEFEF;}");__ci.document.writeln("td.normal {background-color:#EFEFEF;}");__ci.document.writeln("input.l {border: 1px solid #CCCCCC;background-color:#EFEFEF;width:20px;height:20px;}");__ci.document.writeln("input.r {border: 1px solid #CCCCCC;background-color:#EFEFEF;width:20px;height:20px;}");__ci.document.writeln("input.b {border: 1px solid #CCCCCC;background-color:#EFEFEF;width:100%;height:20px;}");__ci.document.writeln("-->");__ci.document.writeln("</style>");__ci.document.writeln("</head>");__ci.document.writeln("<body>");__ci.document.writeln("</body>");__ci.document.writeln("</html>");__ci.document.close();document.writeln("</div>");var calendar=new Calendar();document.onclick=function(){if(calendar.dateControl!=window.event.srcElement){calendar.hide()}};